<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="在路上的coder博客 Java | Redis | JVM | Python ..."><title>Java面试题 | 在路上的coder</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Java面试题</h1><a id="logo" href="/.">在路上的coder</a><p class="description">Coder,Machine Learning</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Java面试题</h1><div class="post-meta">May 17, 2017</div><div class="post-content"><a id="more"></a>
<h2 id="zk分布式锁："><a href="#zk分布式锁：" class="headerlink" title="zk分布式锁："></a>zk分布式锁：</h2><p>详情参考：<a href="http://www.jiacheo.org/blog/620" target="_blank" rel="external">http://www.jiacheo.org/blog/620</a></p>
<p>1.在单机模式下，没有引入zookeeper时，我们可以通过创建一个临时文件加锁，然后在事务处理完毕后，将临时文件删除就代表解锁。这种加锁和解锁模式可以移植到zookeeper上，通过创建一个路径，来证明该锁已经存在，然后删除路径来释放该锁。而同时zookeeper又能支持对节点的监控，这样一来，我们在多机的情况下就能同时且实时知道锁是存在还是已经解锁了。</p>
<p>2.具体流程：</p>
<ul>
<li>在zookeeper存储结构中，假设有一个lock目录。</li>
<li>在该目录下创建自增长的临时节点，这个节点上的数字用于表示获取锁的先后顺序。</li>
<li>假设有三台服务器请求zookeeper创建了，00001、00002、00003 三个节点。然后判断lock目录下的最小节点和自己创建的是否一致，如果一致可以获取锁，如果不一致执行等待操作。</li>
<li>当获取锁的节点执行完后，删除节点，并通知其他节点，在进行比较。</li>
</ul>
<p>3、分布式锁出现死锁，发生死锁的情况主要出现在网络的情况下：</p>
<ul>
<li>出现方式<ul>
<li>假设zk服务收到了请求，子节点创建成功。但是返回给客户端的时候网络发生异常。这时候我们重试，创建的话，就会进入死锁。这里的死锁和平常的死锁不一样，不是回路循环等待，而是相当于这个锁死掉了。因为这个流程其实已经创建了一个节点，但是这个节点没有与客户端关联，称为幽灵节点。</li>
</ul>
</li>
<li>解决方法<ul>
<li>创建节点的时候，将客户端作为节点的一部分，也就是每个节点都有唯一标识的信息。</li>
<li>重试的时候，对每个节点进行判断，对于当前进程创建的节点不重复创建。</li>
</ul>
</li>
</ul>
<h2 id="谈谈分布式"><a href="#谈谈分布式" class="headerlink" title="谈谈分布式"></a>谈谈分布式</h2><ul>
<li>互联网应用满足要求：高吞吐、高并发、低延迟、负载均衡<ul>
<li>高吞吐，意味着你的系统，可以同时承载大量的用户使用。</li>
<li>高并发，做尽量多的处理，同时处理多个任务。</li>
<li>低延迟，大量用户访问时，也能很快返回计算结果。</li>
<li>负载均衡，同时发生的请求，有效的让多个不同服务器承载。</li>
</ul>
</li>
<li>分布式系统提高承载量的基本手段<ul>
<li>分层模型</li>
<li>并发模型</li>
<li>缓存技术</li>
<li>存储技术(NoSql)</li>
</ul>
</li>
</ul>
<h2 id="redis持久化实现原理"><a href="#redis持久化实现原理" class="headerlink" title="redis持久化实现原理"></a>redis持久化实现原理</h2><p><a href="https://cavaliersfor.github.io/2017/06/02/redis持久化/" target="_blank" rel="external">redis持久化</a></p>
<h2 id="生产者消费者"><a href="#生产者消费者" class="headerlink" title="生产者消费者"></a>生产者消费者</h2><h2 id="JVM的内存模型"><a href="#JVM的内存模型" class="headerlink" title="JVM的内存模型"></a>JVM的内存模型</h2><ul>
<li>内存空间（Runtime Data Area）中可以按照是否线程共享分成两块，线程共享的是方法区（Method Area）和堆（Heap），线程独享的是Java栈（Java Stack），本地方法栈（Native Method Stack）和PC寄存器（Program Counter Register）。</li>
<li>在 JDK 1.7 及以往的 JDK 版本中，Java 类信息、常量池、静态变量都存储在 Perm（永久代）里。类的元数据和静态变量在类加载的时候分配到 Perm，当类被卸载的时候垃圾收集器从 Perm 处理掉类的元数据和静态变量。当然常量池的东西也会在 Perm 垃圾收集的时候进行处理。</li>
</ul>
<h2 id="JVM体系结构"><a href="#JVM体系结构" class="headerlink" title="JVM体系结构"></a>JVM体系结构</h2><ul>
<li><p>类加载器<br>在JVM启动时或者在类运行时将需要的class加载到JVM中。</p>
</li>
<li><p>执行引擎<br>执行引擎的任务是负责执行class文件中包含的字节码指令，相当于实际机器上的CPU</p>
</li>
<li><p>内存区<br>将内存划分成若干个区域以模拟实际机器上的存储，记录和调度功能模块</p>
</li>
<li><p>本地方法调用<br>调用C或C++实现的本地方法的代码返回结果</p>
</li>
</ul>
<h2 id="常用GC算法"><a href="#常用GC算法" class="headerlink" title="常用GC算法"></a>常用GC算法</h2><ul>
<li>引用计数法</li>
<li>复制法<br>原理：从根集合开始，通过追踪从From中找到存活对象，拷贝到To中；From和To交换身份，下次内存分配从To开始<br>优缺点：没有标记和清除的过程，效率高；没有内存碎片，可以快速实现内存分配；但是需要双倍空间<br><img src="http://opzxa0ul7.bkt.clouddn.com/GC的复制法.jpg" alt="GC的复制法.jpg"></li>
<li>标记清除法<br>原理：分为两个阶段，标记和清除；标记，从根集合开始扫描，对存活的对象进行标记。清除，扫描整个内存空间，回收未被标记的对象。<br>优缺点：不需要额外空间，但是，两次扫描，耗时严重；会产生碎片<br><img src="http://opzxa0ul7.bkt.clouddn.com/GC标记清除法标记阶段.jpg" alt="GC标记清除法标记阶段"><br><img src="http://opzxa0ul7.bkt.clouddn.com/GC标记清除法清除阶段.jpg" alt="GC标记清除法清除阶段"></li>
<li>标记压缩法<br>原理：分为两个阶段，标记和压缩；标记，从根集合开始扫描，对存活对象进行标记。压缩，再次扫描，并往一端滑动存活对象。<br>优缺点：没有内存碎片，但是需要移动对象的成本<br><img src="http://opzxa0ul7.bkt.clouddn.com/GC标记压缩法标记阶段.jpg" alt="GC标记压缩法标记阶段"><br><img src="http://opzxa0ul7.bkt.clouddn.com/GC标记压缩法压缩阶段.jpg" alt="GC标记压缩法压缩阶段"></li>
<li>标记清除压缩法<br>原理：将标记清除和标记压缩相结合，过程和标记清除一样，但是进行多次GC后才压缩。<br>优缺点：减少了对象的移动成本</li>
</ul>
<h2 id="什么情况下出现Full-GC，什么情况下出现Young-GC"><a href="#什么情况下出现Full-GC，什么情况下出现Young-GC" class="headerlink" title="什么情况下出现Full GC，什么情况下出现Young GC"></a>什么情况下出现Full GC，什么情况下出现Young GC</h2><ul>
<li>对象优先在新生代Eden区分配，如果Eden区没有足够的空间时，就会触发一次young gc</li>
<li>full gc触发的条件有多个，且full gc的时候会出现stop world。<ul>
<li>在执行yong gc之前，JVM会进行空间担保-如果老年代的连续空间小于新生代对象的总大小(或历次晋升的平均大小)，则触发一次full gc。</li>
<li>显示的调用<code>System.gc()</code> 时</li>
<li>大对象直接进入老年代，从年轻代晋升上来的老对象，尝试在老年代分配内存时，但是老年代内存不足时</li>
<li>永生区空间不足时</li>
<li>jmap和jcmd dump文件时候会触发FGC</li>
</ul>
</li>
</ul>
<h2 id="http1-0，http1-1，http2-0区别"><a href="#http1-0，http1-1，http2-0区别" class="headerlink" title="http1.0，http1.1，http2.0区别"></a>http1.0，http1.1，http2.0区别</h2><h2 id="Get-Post对缓存的影响"><a href="#Get-Post对缓存的影响" class="headerlink" title="Get/Post对缓存的影响"></a>Get/Post对缓存的影响</h2><ul>
<li>不支持Post Method。Get可以被浏览器缓存。</li>
</ul>
<h2 id="HTTP请求头和响应头"><a href="#HTTP请求头和响应头" class="headerlink" title="HTTP请求头和响应头"></a>HTTP请求头和响应头</h2><ul>
<li>HTTP请求头</li>
</ul>
<table>
<thead>
<tr>
<th>请求头</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Accept-Charset</td>
<td>用于指定客户端接受的字符集</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>用户指定可接受的内容编码</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>用于指定一种自然语言，如果Accept-Language:zh-cn</td>
</tr>
<tr>
<td>Host</td>
<td>用于指定被请求资源的Internet主机和端口号</td>
</tr>
<tr>
<td>User-Agent</td>
<td>客户端将它的操作系统、浏览器和其他属性告诉服务器</td>
</tr>
<tr>
<td>Connection</td>
<td>当前连接是否保持</td>
</tr>
</tbody>
</table>
<ul>
<li>HTTP响应头</li>
</ul>
<table>
<thead>
<tr>
<th>请求头</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server</td>
<td>使用的服务器名称</td>
</tr>
<tr>
<td>Content-Type</td>
<td>用来指定响应的实体正文的类型</td>
</tr>
<tr>
<td>Content-Encoding</td>
<td>与请求报头Accept-Encoding对应，告诉浏览器服务器端采用的是什么压缩编码</td>
</tr>
<tr>
<td>Content-Language</td>
<td>描述资源所用的自然语言，与Accept-Language对应</td>
</tr>
<tr>
<td>Content-Length</td>
<td>指明实体正文的长度，用以字节方式存储的十进制数字来表示</td>
</tr>
<tr>
<td>Keep-Alive</td>
<td>保持连接的时间</td>
</tr>
</tbody>
</table>
<h2 id="通过三种方式编写单例模式"><a href="#通过三种方式编写单例模式" class="headerlink" title="通过三种方式编写单例模式"></a>通过三种方式编写单例模式</h2><ul>
<li><p>静态内部类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span></span>&#123;</div><div class="line">  	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singletion();</div><div class="line">  &#125;</div><div class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Singletion</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Singletion <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">  	<span class="keyword">return</span> SingletionHolder.INSTANCE;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>枚举</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Singleton&#123;</div><div class="line">	INSTANCE;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>饿汉式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</div><div class="line">   	<span class="keyword">return</span> instance;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="编程技术书籍"><a href="#编程技术书籍" class="headerlink" title="编程技术书籍"></a>编程技术书籍</h2><p><a href="https://github.com/jobbole/awesome-programming-books" target="_blank" rel="external">https://github.com/jobbole/awesome-programming-books</a></p>
</li>
</ul>
<h2 id="NIO核心组件"><a href="#NIO核心组件" class="headerlink" title="NIO核心组件"></a>NIO核心组件</h2><ul>
<li>Channel，可以理解为资源的一个流，通过这个流资源可以从Channel读取Data到一个Buffer中或者从一个Buffer中写入Data到Channel</li>
<li>Buffer，java NIO Buffers 和Channels配合使用</li>
<li>Selectors，Selector组件可以运行判断多个Channel，动态决定使用哪个Channel来执行Read 或者 Write操作。通过这个组件可以上线一个Thread 管理多个Channels 或者 多个网络连接Channel。</li>
</ul>
<h2 id="判断对象可收回"><a href="#判断对象可收回" class="headerlink" title="判断对象可收回"></a>判断对象可收回</h2><ul>
<li><p>可达性分析<br>算法的基本思想是通过一系列被称为”GC Root” 的对象作为起点，从这些起点向下搜索，搜索所有的路径，这些路径称为引用链，当一个对象到GC Root没有任何引用链时，则证明此对象是不可用的可回收；GC Root对象包括</p>
<ul>
<li><p>System class</p>
<p>系统加载类和启动加载类。例如 rt.jar 包中的都是，比如 <code>java.util.*</code></p>
</li>
<li><p>虚拟机栈中引用的对象</p>
</li>
<li><p>方法区中的类静态属性引用的对象</p>
</li>
<li><p>方法区中常量引用的对象</p>
</li>
<li><p>本地方法中引用的对象</p>
</li>
</ul>
</li>
<li><p>引用类型判断<br>JDK有四种引用，分别是强引用、软引用、弱引用、虚引用</p>
<ul>
<li><p>强引用</p>
<p>强引用就是我们平常用的类似于“Object obj = new Object()”的引用，只要obj的生命周期没结束，或者没有显示地把obj指向为null，那么JVM就永远不会回收这种对象 </p>
</li>
<li><p>软引用</p>
<p>软引用相对强引用来说就要脆弱一点，JVM正常运行时，软引用和强引用没什么区别，但是当内存不够用时，濒临逸出的情况下，JVM的垃圾收集器就会把软引用的对象回收。具体演示如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SoftReferenceTest</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        SoftReferenceTest softReferenceTest = <span class="keyword">new</span> SoftReferenceTest();</div><div class="line">        SoftReference&lt;SoftReferenceTest&gt; softReference = <span class="keyword">new</span> SoftReference&lt;&gt;(softReferenceTest);</div><div class="line">        softReferenceTest = <span class="keyword">null</span>;</div><div class="line">        System.out.println(<span class="string">"before softReference:"</span> + softReference.get());</div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">        ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (i++&lt;<span class="number">100000000</span>)&#123;</div><div class="line">            list.add(String.valueOf(i));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"end"</span>);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        <span class="keyword">super</span>.finalize();</div><div class="line">        System.out.println(<span class="string">"SoftReferenceTest finalize"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当调小值的时候不会执行<code>finalize()</code>方法</p>
</li>
<li><p>弱引用</p>
<p>弱引用比软引用更加脆弱，弱引用的对象将会在下一次的gc被回收，不管JVM内存被占用多还是少。</p>
</li>
<li><p>虚引用</p>
<p>虚引用是最脆弱的引用 </p>
</li>
</ul>
</li>
</ul>
<h2 id="中文编码问题"><a href="#中文编码问题" class="headerlink" title="中文编码问题"></a>中文编码问题</h2><ul>
<li>中文变成了看不懂的字符<br>字符串在解码时所用的字符集与编码字符集不一致导致。<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">String encode = URLEncoder.encode(<span class="string">"淘！我喜欢"</span>,<span class="string">"GBk"</span>);</div><div class="line">System.out.println(encode);</div><div class="line">String errorDecode = URLDecoder.decode(encode, <span class="string">"ISO-8859-1"</span>);</div><div class="line">System.out.println(errorDecode);</div><div class="line">String decode = URLDecoder.decode(encode, <span class="string">"GBk"</span>);</div><div class="line">System.out.println(decode);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>输出如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">encode：%CC%D4%A3%A1%CE%D2%CF%B2%BB%B6</div><div class="line">errorDecode：ÌÔ£¡ÎÒÏ²»¶</div><div class="line">decode：淘！我喜欢</div></pre></td></tr></table></figure></p>
<ul>
<li>一个汉字变成一个问号<br>将中文和中文符号经过不支持中文的<code>ISO-8859-1</code>编码后，所有字符变成 <code>?</code>，这是因为使用<code>ISO-8859-1</code> 进行解码时，遇到不在码值范围内的字符会统一用<code>3f</code>表示，这也是常说的“黑洞”，所以<code>ISO-8859-1</code> 不认识的字符都会变成’?’。<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String encode = URLEncoder.encode(<span class="string">"淘！我喜欢"</span>, <span class="string">"ISO-8859-1"</span>);</div><div class="line">System.out.println(<span class="string">"encode："</span>+encode);</div><div class="line">String decode = URLDecoder.decode(encode, <span class="string">"ISO-8859-1"</span>);</div><div class="line">System.out.println(<span class="string">"decode："</span>+decode);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>输出为：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">encode：%<span class="number">3F</span>%<span class="number">3F</span>%<span class="number">3F</span>%<span class="number">3F</span>%<span class="number">3F</span></div><div class="line">decode：?????</div></pre></td></tr></table></figure></p>
<ul>
<li>一个汉字变成两个问号<br>这种情况比较复杂，中文经过多次编码，但是其中一次编码或者解码不对仍然会出现中文字符变成’?’的情况</li>
</ul>
<h2 id="Spring的优缺点"><a href="#Spring的优缺点" class="headerlink" title="Spring的优缺点"></a>Spring的优缺点</h2><p>   优点</p>
<ul>
<li>提供了一种管理对象的方法，可以把中间层对象有效地组织起来。一个完美的框架“黏合剂”。</li>
<li>采用了分层结构，可以增量引入到项目中。</li>
<li>有利于面向接口编程习惯的养成。</li>
<li>目的之一是为了写出易于测试的代码。</li>
<li>非侵入性，应用程序对Spring API的依赖可以减至最小限度。</li>
<li>一致的数据访问界面。</li>
<li>一个轻量级的架构解决方案。</li>
</ul>
<p>　缺点：</p>
<ul>
<li>中断了应用程序的逻辑，使代码变得不完整，不直观。此时单从Source无法完全把握应用的所有行为。</li>
<li>将原本应该代码化的逻辑配置化，增加了出错的机会以及额外的负担。</li>
<li>调试阶段不直观，后期的bug对应阶段，不容易判断问题所在。 </li>
</ul>
<h2 id="单例模式的优缺点"><a href="#单例模式的优缺点" class="headerlink" title="单例模式的优缺点"></a>单例模式的优缺点</h2><p>优点：</p>
<ul>
<li>在单例模式中，活动的单例只有一个实例，对单例类的所有实例化得到的都是相同的一个实例。这样就 防止其它对象对自己的实例化，确保所有的对象都访问一个实例 </li>
<li>单例模式具有一定的伸缩性，类自己来控制实例化进程，类就在改变实例化进程上有相应的伸缩性。 </li>
<li>提供了对唯一实例的受控访问。 </li>
<li>由于在系统内存中只存在一个对象，因此可以 节约系统资源，当 需要频繁创建和销毁的对象时单例模式无疑可以提高系统的性能。 </li>
<li>允许可变数目的实例。 </li>
<li>避免对共享资源的多重占用。 </li>
</ul>
<p>缺点： </p>
<ul>
<li>不适用于变化的对象，如果同一类型的对象总是要在不同的用例场景发生变化，单例就会引起数据的错误，不能保存彼此的状态。 </li>
<li>由于单利模式中没有抽象层，因此单例类的扩展有很大的困难。 </li>
<li>单例类的职责过重，在一定程度上违背了“单一职责原则”。 </li>
<li>滥用单例将带来一些负面问题，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；如果实例化的对象长时间不被利用，系统会认为是垃圾而被回收，这将导致对象状态的丢失。 </li>
</ul>
<h2 id="唯一索引的作用"><a href="#唯一索引的作用" class="headerlink" title="唯一索引的作用"></a>唯一索引的作用</h2><h2 id="共享锁和排他锁"><a href="#共享锁和排他锁" class="headerlink" title="共享锁和排他锁"></a>共享锁和排他锁</h2><h3 id="共享锁"><a href="#共享锁" class="headerlink" title="共享锁"></a>共享锁</h3><p>共享锁又称读锁，是读取操作创建的锁。其他用户可以并发读取数据，但任何事务不能对数据进行修改(获取数据上的排他锁)。如果事务T对数据A加上共享锁后，则其他事务只能对A再加共享锁，不能加排他锁。获取共享锁的事务只能读数据，不能修改数据。</p>
<h3 id="排他锁"><a href="#排他锁" class="headerlink" title="排他锁"></a>排他锁</h3><p>排他锁又称写锁，如果事务T对数据A加上排他锁后，其他事务不能再对A加任何类型的锁。获取排他锁的事务既能读数据，又能修改数据。</p>
<h2 id="数据库隔离级别"><a href="#数据库隔离级别" class="headerlink" title="数据库隔离级别"></a>数据库隔离级别</h2><ul>
<li>读未提交的，另一个事务修改了数据，但尚未提交，而本事务中的select会读到这些未被提交的数据(也就是脏读)。脏读就是指另一个事务修改了数据，但尚未提交，而本事务中的select会读到这些未被提交的数据</li>
<li>读已提交的，本事务读取到的是最新的数据(其他事务提交后的)。问题是，在同一个事务里，前后执行相同的 select会读到不同的结果(不可重复读)。不可重复读，指同一个事务执行过程中，另外一个事务提交了新数据，因此本事务先后两次读到的数据结果不一致</li>
<li>可重复读，在同一事务中，SELECT的结果是事务开始时间点的状态，同样的SELECT操作读到的结果会是一致的。但是，会有幻读现象。可重复读保证了同一个事务里，查询的结果都是事务开始时的状态（一致性）。但是，如果另一个事务同时提交了新数据，本事务再更新时，就会发现了这些新数据，貌似之前读到的数据是幻觉，这就是幻读。</li>
<li>串行化，所有事务只能一个个执行，不能并发</li>
</ul>
<ul>
<li><h2 id="数据库隔离级别出现的问题"><a href="#数据库隔离级别出现的问题" class="headerlink" title="数据库隔离级别出现的问题"></a>数据库隔离级别出现的问题</h2><ul>
<li>脏读：对于两个事务T1，T2，T1读取了已经被T2更新但还没有提交的字段，之后，若T2回滚，T1读取到的内容就是临时无效的内容。</li>
<li>不可重复读：对于事务T1，T2，T1需要读取一个字段两次，在第一次和第二次读取之间，T2更新了该字段，导致T1第二次读取到的内容值不同。出现这样的原因是，T1事务读取完数据后释放了共享锁，导致T2可以获取排他锁对数据进行修改，所以第二次看到数据不一致。</li>
<li>幻读： 事务A读取与搜索条件相匹配的若干行。事务B以插入或删除行等方式来修改事务A的结果集，然后再提交。 幻读与不可重复读之间的区别是幻读强调的是新增或删除,而不可重复读强调的是修改。这是在可重复读的事务级别下出现的现象，在该事务级别下，T1读完数据后，不到事务提交是不会释放共享锁的，也就是其他事务不能获取到排他锁对已读到的数据进行修改，实现了可重复读；但是其他事务可以执行insert语句，这样就导致出现幻读。</li>
</ul>
</li>
</ul>
<h2 id="分布式、集群、负载均衡的理解"><a href="#分布式、集群、负载均衡的理解" class="headerlink" title="分布式、集群、负载均衡的理解"></a>分布式、集群、负载均衡的理解</h2><p>集群：同一个业务，部署在多个服务器上。<br>分布式：一个业务分拆成多个子业务，或者本身就是不同的业务，部署在不同的服务器上。<br>负载均衡：通过负载均衡算法，将用户的请求转发给后台内网服务器。达到访问的负载均衡</p>
<h3 id="负载均衡算法"><a href="#负载均衡算法" class="headerlink" title="负载均衡算法"></a>负载均衡算法</h3><ul>
<li>轮询（RoundRobin）将请求顺序循环地发到每个服务器。当其中某个服务器发生故障，AX就把其从顺序循环队列中拿出，不参加下一次的轮询，直到其恢复正常。</li>
<li>比率（Ratio）：给每个服务器分配一个加权值为比例，根椐这个比例，把用户的请求分配到每个服务器。当其中某个服务器发生故障，AX就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。</li>
<li>优先权（Priority）：给所有服务器分组，给每个组定义优先权，将用户的请求分配给优先级最高的服务器组（在同一组内，采用预先设定的轮询或比率算法，分配用户的请求）；当最高优先级中所有服务器或者指定数量的服务器出现故障，AX将把请求送给次优先级的服务器组。这种方式，实际为用户提供一种热备份的方式。</li>
<li>最少连接数（LeastConnection）：AX会记录当前每台服务器或者服务端口上的连接数，新的连接将传递给连接数最少的服务器。当其中某个服务器发生故障，AX就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。</li>
<li>最快响应时间（Fast Reponse time）：新的连接传递给那些响应最快的服务器。当其中某个服务器发生故障，AX就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。</li>
<li>哈希算法( hash): 将客户端的源地址，端口进行哈希运算，根据运算的结果转发给一台服务器进行处理，当其中某个服务器发生故障，就把其从服务器队列中拿出，不参加下一次的用户请求的分配，直到其恢复正常。</li>
<li>基于数据包的内容分发：例如判断HTTP的URL，如果URL中带有.jpg的扩展名，就把数据包转发到指定的服务器。</li>
</ul>
<h2 id="悲观锁和乐观锁"><a href="#悲观锁和乐观锁" class="headerlink" title="悲观锁和乐观锁"></a>悲观锁和乐观锁</h2><ul>
<li><p>悲观锁（Pessimistic Lock）：<br>顾名思义，就是很悲观，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会Lock直到它拿到锁。</p>
</li>
<li><p>乐观锁（Optimistic Lock）：<br>顾名思义，就是很乐观，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。</p>
</li>
</ul>
<h3 id="适用场景："><a href="#适用场景：" class="headerlink" title="适用场景："></a>适用场景：</h3><ul>
<li><p>悲观锁：比较适合写入操作比较频繁的场景，如果出现大量的读取操作，每次读取的时候都会进行加锁，这样会增加大量的锁的开销，降低了系统的吞吐量。</p>
</li>
<li><p>乐观锁：比较适合读取操作比较频繁的场景，如果出现大量的写入操作，数据发生冲突的可能性就会增大，为了保证数据的一致性，应用层需要不断的重新获取数据，这样会增加大量的查询操作，降低了系统的吞吐量。</p>
<p>总结：两种所各有优缺点，读取频繁使用乐观锁，写入频繁使用悲观锁。</p>
</li>
</ul>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2017/05/20/redis介绍和安装/">redis入门与安装</a><a class="next" href="/2017/05/17/hello-world/">Hexo使用方法</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/tags/JMS/" style="font-size: 15px;">JMS</a> <a href="/tags/Spring-Boot自动配置详解/" style="font-size: 15px;">Spring Boot自动配置详解</a> <a href="/tags/Spring-Boot/" style="font-size: 15px;">Spring Boot</a> <a href="/tags/ElasticSearch/" style="font-size: 15px;">ElasticSearch</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/GC参数介绍/" style="font-size: 15px;">GC参数介绍</a> <a href="/tags/学习视频/" style="font-size: 15px;">学习视频</a> <a href="/tags/JVM算法与种类/" style="font-size: 15px;">JVM算法与种类</a> <a href="/tags/JVM参数配置/" style="font-size: 15px;">JVM参数配置</a> <a href="/tags/Java架构师之路/" style="font-size: 15px;">Java架构师之路</a> <a href="/tags/JVM运行机制介绍/" style="font-size: 15px;">JVM运行机制介绍</a> <a href="/tags/Java集合源码/" style="font-size: 15px;">Java集合源码</a> <a href="/tags/ArrayList源码/" style="font-size: 15px;">ArrayList源码</a> <a href="/tags/UML/" style="font-size: 15px;">UML</a> <a href="/tags/UML时序图/" style="font-size: 15px;">UML时序图</a> <a href="/tags/HashMap源码/" style="font-size: 15px;">HashMap源码</a> <a href="/tags/Java工具类源码/" style="font-size: 15px;">Java工具类源码</a> <a href="/tags/NumberUtils使用介绍/" style="font-size: 15px;">NumberUtils使用介绍</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Spring-IOC源码/" style="font-size: 15px;">Spring IOC源码</a> <a href="/tags/Spring-IOC工作流程/" style="font-size: 15px;">Spring IOC工作流程</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/nosql/" style="font-size: 15px;">nosql</a> <a href="/tags/缓存/" style="font-size: 15px;">缓存</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/idea快捷键/" style="font-size: 15px;">idea快捷键</a> <a href="/tags/ActiveMQ安装/" style="font-size: 15px;">ActiveMQ安装</a> <a href="/tags/js正则表达式/" style="font-size: 15px;">js正则表达式</a> <a href="/tags/电话号码正则表达式/" style="font-size: 15px;">电话号码正则表达式</a> <a href="/tags/邮箱正则表达式/" style="font-size: 15px;">邮箱正则表达式</a> <a href="/tags/maven配置/" style="font-size: 15px;">maven配置</a> <a href="/tags/maven配置远程仓库/" style="font-size: 15px;">maven配置远程仓库</a> <a href="/tags/maven配置编译级别/" style="font-size: 15px;">maven配置编译级别</a> <a href="/tags/Python高级语法/" style="font-size: 15px;">Python高级语法</a> <a href="/tags/python3/" style="font-size: 15px;">python3</a> <a href="/tags/python入门/" style="font-size: 15px;">python入门</a> <a href="/tags/redis主从复制/" style="font-size: 15px;">redis主从复制</a> <a href="/tags/redis安装/" style="font-size: 15px;">redis安装</a> <a href="/tags/redis集群添加节点/" style="font-size: 15px;">redis集群添加节点</a> <a href="/tags/redis集群水平扩展/" style="font-size: 15px;">redis集群水平扩展</a> <a href="/tags/redis持久化/" style="font-size: 15px;">redis持久化</a> <a href="/tags/redis哨兵模式/" style="font-size: 15px;">redis哨兵模式</a> <a href="/tags/redis集群/" style="font-size: 15px;">redis集群</a> <a href="/tags/redis集群移除节点/" style="font-size: 15px;">redis集群移除节点</a> <a href="/tags/Spring-AOP使用/" style="font-size: 15px;">Spring AOP使用</a> <a href="/tags/Spring4/" style="font-size: 15px;">Spring4</a> <a href="/tags/JVM和JDK介绍/" style="font-size: 15px;">JVM和JDK介绍</a> <a href="/tags/java爬取今日头条文章/" style="font-size: 15px;">java爬取今日头条文章</a> <a href="/tags/java爬虫/" style="font-size: 15px;">java爬虫</a> <a href="/tags/http请求过程，/" style="font-size: 15px;">http请求过程，</a> <a href="/tags/DNS解析过程/" style="font-size: 15px;">DNS解析过程</a> <a href="/tags/类加载器/" style="font-size: 15px;">类加载器</a> <a href="/tags/JVM监控处理工具/" style="font-size: 15px;">JVM监控处理工具</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/09/SpringBoot集成ES/">SpringBoot集成ES</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/08/ElasticSearch高级查询/">ElasticSearch高级查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/05/ElasticSearch入门/">ElasticSearch入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/04/python高级语法与用法/">python3高级语法与用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/13/python3基础和进阶/">python3基础和进阶</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/17/Boot自动配置实战/">Spring Boot自动配置实战</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/11/spring中AOP的使用/">Spring中AOP的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/19/OO与UML/">OO与UML</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/05/虚拟机性能监控和处理工具/">虚拟机性能监控和处理工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/16/类装载器/">类装载器</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://ifeve.com/" title="并发编程网" target="_blank">并发编程网</a><ul></ul><a href="http://blog.csdn.net/facekbook" title="CSDN博客" target="_blank">CSDN博客</a><ul></ul><a href="http://coolshell.cn/" title="酷客" target="_blank">酷客</a><ul></ul><a href="http://www.ruanyifeng.com/home.html" title="阮一峰博客" target="_blank">阮一峰博客</a><ul></ul><a href="http://www.jiuzhang.com/" title="九章算法" target="_blank">九章算法</a><ul></ul><a href="http://www.lintcode.com/zh-cn/" title="LintCode" target="_blank">LintCode</a><ul></ul><a href="https://www.ibm.com/developerworks/cn/" title="developerWorks" target="_blank">developerWorks</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">在路上的coder.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>